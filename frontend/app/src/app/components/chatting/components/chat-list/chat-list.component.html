<div class="container-fluid bg-white rounded shadow-sm" style="height: 100%;">
  <div class="row h-100 rounded">


    <div class="col-3 border-end d-flex flex-column h-100">
      <!-- Header -->
      <div class="p-2 border-bottom d-flex justify-content-between align-items-center">
        <h5 class="m-0">Chats</h5>  
        <div   class="p-2  d-flex justify-content-between align-items-center"d>

      
        <button (click)=" openNewChatDialog(newChatDialog, false)"
          class="btn btn-success rounded-circle shadow-lg d-flex align-items-center justify-content-center m-1"
          style="width:50px; height:50px;" title="New chat" aria-label="New chat">
          <i class="bi bi-chat-dots" style="font-size:18px; color:#fff;"></i>
        </button>

        <button (click)=" openNewChatDialog(newGroupDialog,true)"
          class="btn btn-success rounded-circle shadow-lg d-flex align-items-center justify-content-center"
          style="width:50px; height:50px;" title="New group" aria-label="New chat">
           <mat-icon>groups</mat-icon>
        </button>
          </div>
         
         
        <ng-template #newChatDialog>

        

          <mat-dialog-content class="p-1">
         
            <!-- Search Bar -->
            <div class="p-2 border-bottom">
              <mat-form-field appearance="outline" class="w-100">
                <mat-icon matPrefix>search</mat-icon>
                <input matInput placeholder="Search contacts" [(ngModel)]="groupSearchTerm"
                  (ngModelChange)="($event || '').trim() ? getGroupCandidates() : contacts.set([])"
                  (keydown.enter)="$event.preventDefault(); groupSearchTerm.trim() && getGroupCandidates()" />
              </mat-form-field>
            </div>

            
            <!-- Contact List -->
            <div class="list-group list-group-flush overflow-auto" style="max-height: calc(60vh);">
              @for (c of contacts(); track c.userAvatar?.userId) {
              @if (c.canBeMessagedByCurrentUser) {
              <button mat-list-item class="list-group-item list-group-item-action d-flex align-items-center">
                <!-- Checkbox for group selection -->
              
                <img [src]="processImage(c.userAvatar.profilePicture)"
                  (error)="onImageError($event, 'assets/ProfileAvatar.png')" class="rounded-circle me-2" width="42"
                  height="42" />

                <div class="flex-grow-1 text-start">
                  <div class="fw-semibold">{{ c.userAvatar.username }}</div>
                  <small class="text-muted">{{ c.profileBio }}</small>
                </div>

               <!-- Direct Chat Button (hidden in group mode) -->
@if(isGroupMode) {
   <button 
    type="button" 
    class="btn btn-sm btn-outline-primary ms-2" 
    title="Open chat" 
    aria-label="Open chat" 
    (click)="c.canBeAddedToGroupByCurrentUser=!c.canBeAddedToGroupByCurrentUser">
<i class="bi" 
   [ngClass]="{
     'bi-person-plus-fill': c.canBeAddedToGroupByCurrentUser,
     'bi-person-dash-fill': !c.canBeAddedToGroupByCurrentUser
   }">
</i>

   
   
  </button>
} @else {
  <button 
    type="button" 
    class="btn btn-sm btn-outline-primary ms-2" 
    title="Open chat" 
    aria-label="Open chat" 
    (click)="$event.stopPropagation(); openChat(c.userAvatar.userId)">
    <i class="bi bi-chat-dots"></i>
  </button>
}
                
              </button>
              }
              }
              @if ((contacts() || []).length === 0) {
              <div class="text-center text-muted p-4">
                No contacts found
              </div>
              }
            </div>

          </mat-dialog-content>

          <mat-dialog-actions align="center" class="d-flex justify-content-evenly  p-2">
            @if (isGroupMode) {

            
   <button type="button" class="btn telegram-primary-btn"
            (click)=" closeDialog(); createGroupChat( )"
            style="font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px;">
     create
    </button> 
  }
     <button type="button" class="btn telegram-primary-btn"
            (click)=" closeDialog(); openNewChatDialog( newChatDialog ,true)"
            style="font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px;">
     Close
    </button>
            </mat-dialog-actions>
        </ng-template>

 <ng-template #newGroupDialog>
  <div class="modal-content p-4 d-flex flex-column gap-4" style="max-width: 400px;">
    <!-- Header -->
    <h2 class="modal-title m-0" style="font-weight: 600; color: #000;">New Group</h2>

    <!-- Group Avatar + Name -->
    <div class="d-flex align-items-center gap-3">
      <!-- Avatar upload -->
      <div class="position-relative">
        @if (groupAvatarPreview) {
          <img [src]="groupAvatarPreview"
               class="rounded-circle shadow-sm"
               style="width: 64px; height: 64px; object-fit: cover;" />
        } @else {
          <div class="rounded-circle d-flex align-items-center justify-content-center"
               style="width: 64px; height: 64px; background-color: #eceff1;">
            <i class="bi bi-people" style="font-size: 32px; color: #546e7a;"></i>
          </div>
        }
        <button class="btn position-absolute telegram-camera-btn p-0"
                style="bottom: -4px; right: -4px;"
                (click)="GroupAvatar.click()">
          <i class="bi bi-camera-fill" style="font-size: 18px; color: #2c3a9f;"></i>
        </button>
        <input type="file" #GroupAvatar hidden accept="image/*" (change)="onGroupAvatarSelected($event)" />
      </div>

      <!-- Group name input -->
      <div class="form-group flex-grow-1">
        <label for="groupNameInput" class="form-label" style="color: #546E7A; font-size: 14px;">Group name</label>
        <input type="text" id="groupNameInput" class="form-control telegram-input"
               [(ngModel)]="groupName" placeholder="Enter group name" maxlength="128" />
        @if (groupName?.length > 0) {
          <small class="form-text text-muted">{{groupName.length}}/128</small>
        }
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="modal-footer justify-content-end p-3 gap-3">
    <button type="button" class="btn telegram-secondary-btn"
            (click)="closeDialog()" style="font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px;">
      Cancel
    </button>
    <button type="button" class="btn telegram-primary-btn"
            [disabled]="!groupName?.trim() || groupName.length > 128"
            (click)=" closeDialog(); openNewChatDialog( newChatDialog ,true)"
            style="font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px;">
      Next
    </button>
  </div>
</ng-template>

<style>
  .telegram-primary-btn {
    background-color: #156990 !important;
    color: white !important;
    border-radius: 24px !important;
    padding: 10px 28px !important;
    border: none !important;
    transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease !important;
  }

  .telegram-primary-btn:hover {
    background-color: #0288D1 !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important;
    transform: scale(1.02) !important;
  }

  .telegram-primary-btn:active {
    background-color: #0277BD !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3) !important;
    transform: scale(0.98) !important;
  }

  .telegram-primary-btn:disabled {
    background-color: #B0BEC5 !important;
    color: #ECEFF1 !important;
    cursor: not-allowed !important;
    box-shadow: none !important;
  }

  .telegram-secondary-btn {
    color: #546E7A !important;
    border-radius: 24px !important;
    padding: 10px 20px !important;
    border: none !important;
    transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease !important;
  }

  .telegram-secondary-btn:hover {
    background-color: #ECEFF1 !important;
    color: #0288D1 !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important;
  }

  .telegram-secondary-btn:active {
    background-color: #CFD8DC !important;
    color: #0277BD !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3) !important;
  }

  .telegram-camera-btn {
    background-color: white !important;
    width: 38px !important;
    height: 38px !important;
    border-radius: 50% !important;
    /* box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3) !important; */
    transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease !important;
    top: 40px;
    left: 11px;

  }

  .telegram-camera-btn:hover {
    background-color: #dce1e9 !important;
    color: white !important;
    transform: scale(1.005) !important;
   }

  .telegram-camera-btn:active {
    background-color: #ECEFF1 !important;
    transform: scale(0.9) !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3) !important;
  }

  .telegram-input {
    background-color: #F5F7FA !important;
    border-radius: 8px !important;
    border: none !important;
    padding: 12px !important;
    caret-color: #40C4FF !important;
  }

  .telegram-input:focus {
    border-color: #40C4FF !important;
    box-shadow: 0 0 0 0.25rem rgba(64, 196, 255, 0.25) !important;
  }

  .form-label {
    margin-bottom: 0.25rem !important;
  }

  .form-text {
    margin-top: 0.25rem !important;
  }
</style>


      </div>
      <div class="p-2 border-bottom d-flex align-items-center justify-content-between">
        <div class="input-group input-group-sm me-2" style="flex: 1 1 auto;">
          <span class="input-group-text"><i class="fas fa-search"></i></span>
          <input #searchInput type="text" class="form-control" placeholder="Search chats" [(ngModel)]="searchTerm"
            onfocus="if(!this.dataset.bc) this.dataset.bc=getComputedStyle(this).borderColor; this.style.outline='none'; this.style.boxShadow='none'; this.style.borderColor=this.dataset.bc;"
            onblur="this.style.boxShadow='none';" />
          @if(searchTerm) {
          <button class="btn btn-outline-secondary btn-sm" type="button" (click)="searchTerm=''; searchInput.focus()"
            title="Clear search" aria-label="Clear search"
            style="outline:none; box-shadow:none; background-color:#80bd7b  ; border:hidden;"
            (mousedown)="$event.preventDefault()">
            <i class="bi bi-x-lg"></i>
          </button>
          }
        </div>


      </div>



      <!-- Chat List (scrollable) -->
      <div class="flex-grow-1 overflow-auto" (click)="closeContextMenu()">

        <div class="text-center text-muted mt-4">
          @if(!loadingChats()) {
          <svg width="96" height="64" viewBox="0 0 96 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"
            style="margin: 0 auto; display: block;">
            <!-- chat bubble -->
            <rect x="8" y="4" rx="12" ry="12" width="80" height="44" fill="#f1f3f5" />
            <!-- tail -->
            <path d="M32 48 L38 40 L36 48 Z" fill="#f1f3f5" />
            <!-- animated dots -->
            <g transform="translate(18,18)" fill="#6c757d">
              <circle cx="6" cy="8" r="4">
                <animate attributeName="cy" values="8;4;8" dur="1s" repeatCount="indefinite" begin="0s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0s" />
              </circle>
              <circle cx="22" cy="8" r="4">
                <animate attributeName="cy" values="8;2;8" dur="1s" repeatCount="indefinite" begin="0.12s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0.12s" />
              </circle>
              <circle cx="38" cy="8" r="4">
                <animate attributeName="cy" values="8;4;8" dur="1s" repeatCount="indefinite" begin="0.24s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0.24s" />
              </circle>
            </g>
          </svg>
          } @else if(chats().length === 0) {
          <i class="bi bi-chat-dots" style="font-size: 48px;"></i>
          <p class="mt-2">No chats available</p>
          }
        </div>


        @for (chat of filteredChats; track chat.chatId) {
        <div class="chat-item d-flex align-items-center p-2 border-bottom cursor-pointer" (click)="chatClicked(chat)"
          (contextmenu)="openContextMenu($event, chat)">

          <!-- Left: Avatar -->
          <div class="me-2">
            <img [src]="processImage(chat.chatPicture)" (error)="onImageError($event, 'assets/ProfileAvatar.png')"
              class="rounded-circle" width="50" height="50" alt="">
          </div>

          <!-- Middle: Chat Info -->
          <div class="flex-grow-1 d-flex flex-column overflow-hidden">
            <div class="d-flex justify-content-between align-items-center">
              <span class="fw-semibold text-truncate d-flex align-items-center gap-1" style="max-width: 70%;">
                {{ chat.name }}

                <!-- Pinned -->
                @if(chat.pinned) {
                <i style="color: rgb(26, 81, 175);" class="bi bi-pin-angle-fill"></i>
                }
              </span>

              <!-- Time -->
              <small class="text-muted">{{ chat.lastMessageTime | date:'HH:mm' }}</small>
            </div>

            <div class="d-flex justify-content-between align-items-center">
              <!-- Last message -->
              <small class="text-muted text-truncate" style="max-width: 70%;">
                <small class="text-muted text-truncate" style="max-width: 70%;">
                  @if(chat.messageType == 'IMAGE') {
                  photo <i class="bi bi-image-fill"></i>
                  } @else if(chat.messageType == 'VIDEO') {
                  video <i class="bi bi-camera-video-fill"></i>
                  } @else {
                  {{ wrapMessage(chat.lastMessage) }}
                  }
                </small>

              </small>

              <div class="d-flex align-items-center gap-1">
                <!-- Unread badge -->
                @if(chat.unreadCount) {
                <span class="badge bg-success rounded-pill px-2">{{ chat.unreadCount }}</span>
                }

                <!-- Muted -->
                @if(chat.muted) {
                <mat-icon class="text-muted" style="font-size: 16px;">notifications_off</mat-icon>
                }
              </div>
            </div>
          </div>

        </div>
        }

        <!-- Context Menu -->
        @if(contextMenuVisible) {
        <div class="position-fixed bg-white border rounded shadow p-2" [style.top.px]="contextMenuPosition.y"
          [style.left.px]="contextMenuPosition.x" style="z-index: 1000; width: 150px;">
          <button class="dropdown-item" (click)="togglePinChat(contextMenuChat)">
            {{ contextMenuChat.pinned ? 'Unpin' : 'Pin to Top' }}
          </button>
          <button class="dropdown-item" (click)="toggleMuteChat(contextMenuChat)">
            {{ contextMenuChat.muted ? 'Unmute' : 'Mute' }}
          </button>
          <button class="dropdown-item" (click)="deleteChat(contextMenuChat.chatId)">
            delete
          </button>
        </div>
        }

      </div>

    </div>

    <!-- Chat Content -->
    <div class="col-9 d-flex flex-column h-100">
      @if(isChatSelected()) {

      <!-- Chat Header -->
      <div class="p-2 border-bottom d-flex align-items-center bg-white sticky-top">
        <img [src]="processImage(chatSelected().chatPicture)" (error)="onImageError($event, 'assets/ProfileAvatar.png')"
          class="rounded-circle me-2" width="40" height="40" alt="">
        <strong>{{ chatSelected().name }}</strong>
      </div>

      <!-- Messages -->
      <div #scrollContainer class="overflow-auto p-3 h-100 bg-light chat-scrollbar">

        @if(!loadingMessages()) {

        <div class="d-flex align-items-center justify-content-center p-4">
          <svg width="96" height="64" viewBox="0 0 96 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <rect x="8" y="4" rx="12" ry="12" width="80" height="44" fill="#f1f3f5" />
            <path d="M32 48 L38 40 L36 48 Z" fill="#f1f3f5" />
            <g transform="translate(18,18)" fill="#6c757d">
              <circle cx="6" cy="8" r="4">
                <animate attributeName="cy" values="8;4;8" dur="1s" repeatCount="indefinite" begin="0s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0s" />
              </circle>
              <circle cx="22" cy="8" r="4">
                <animate attributeName="cy" values="8;2;8" dur="1s" repeatCount="indefinite" begin="0.12s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0.12s" />
              </circle>
              <circle cx="38" cy="8" r="4">
                <animate attributeName="cy" values="8;4;8" dur="1s" repeatCount="indefinite" begin="0.24s" />
                <animate attributeName="opacity" values="0.3;1;0.3" dur="1s" repeatCount="indefinite" begin="0.24s" />
              </circle>
            </g>
          </svg>
        </div>
        } @else if (messagesToSelectedChatt().length === 0) {
        <div class="text-center text-muted mt-4">
          <i class="bi bi-chat-dots" style="font-size: 48px;"></i>
          <p class="mt-2 mb-0">No messages yet. Send the first message to start the conversation.</p>
        </div>
        }@else {
        @for (m of messagesToSelectedChatt() ; track m.messageId) {
        <div class="d-flex mb-2" [class.justify-content-end]="m.senderAvatar.userId == activeUserId"
          [class.justify-content-start]="m.senderAvatar.userId != activeUserId">
          <!-- Avatar (only for received messages) -->
          @if(m.senderAvatar.userId != activeUserId) {
          <img class="rounded-circle me-2 align-self-end" width="28" height="28"
            [src]="processImage(m.senderAvatar.profilePicture)"
            (error)="onImageError($event,'assets/ProfileAvatar.png')" />
          }

          <!-- Chat Bubble -->
          <div #messageElement class="chat-bubble shadow-sm p-2" [ngClass]="{
          'sent': m.senderAvatar.userId == activeUserId,
          'received': m.senderAvatar.userId != activeUserId
        }" [attr.data-message-id]="m.messageId">
            <!-- Reply preview -->
            @if(m.parentMessageId) {
            <div class="replied-message p-1 mb-2 rounded bg-secondary bg-opacity-10"
              (click)="scrollToParentMessage(m.parentMessageId);    ">
              <small class="text-muted">
                <strong>
                  {{
                  getTheParentMesaage(m.parentMessageId).senderAvatar.userId == activeUserId
                  ? 'You'
                  : getTheParentMesaage(m.parentMessageId).senderAvatar.username
                  }}
                </strong>
                <div class="text-truncate">
                  @if( getTheParentMesaage(m.parentMessageId).media){
                  <img [src]="processImage(getTheParentMesaage(m.parentMessageId).media)" class="message-media mb-1" />


                  }

                </div>
                <div class="text-truncate">{{ getTheParentMesaage(m.parentMessageId).content }}</div>
              </small>
            </div>
            }
            <div [matMenuTriggerFor]="msgMenu" #menuTrigger="matMenuTrigger"
              (contextmenu)="$event.preventDefault(); menuTrigger.openMenu()">



              <!-- Media -->
              @if(m.media) {
              <div class="message-media-wrapper mb-1">
                <!-- IMAGE -->
                @if(m.messageType== 'IMAGE') {


                <img [src]="processImage(m.media)" class="message-media" />
                }
                @if(m.messageType== 'VIDEO') {

                <!-- VIDEO -->
                <video [src]="processVideo(m.media )" controls class="message-media rounded"></video>
                }

              </div>
              }


              <!-- Text -->
              @if(m.content) {
              <div class="text-content">{{ m.content }}</div>
              }

              <!-- Meta inside bubble -->
              <div class="chat-meta text-end mt-1">
                <small class="text-muted me-1">{{ m.sentAt | date:'shortTime' }}</small>
                @if(activeUserId == m.senderAvatar.userId) {
                <i class="bi" [ngClass]="{
                'bi-check-lg': m.messageStatus === MessageStatus.SENT,
                'bi-check-all': m.messageStatus === MessageStatus.DELIVERED || m.messageStatus === MessageStatus.READ,
                'text-primary': m.messageStatus === MessageStatus.READ
              }"></i>
                }
              </div>
            </div>
          </div>
        </div>

        <!-- Context menu -->
        <mat-menu #msgMenu="matMenu">
          <ng-template matMenuContent let-data="matMenuTriggerData">
            <button mat-menu-item (click)="startReply(m)"><mat-icon>reply</mat-icon><span>Reply</span></button>
            <button mat-menu-item (click)="copy(m.content)"><mat-icon>content_copy</mat-icon><span>Copy</span></button>
              @if(m.senderAvatar.userId == activeUserId) {
             <button mat-menu-item (click)="openInfoFromContext(menuTrigger, infoMenu, m)">
              <mat-icon>info</mat-icon><span>Info</span>
            </button>
            }
          </ng-template>
        </mat-menu>
        <!-- Component.html -->
        <mat-menu #infoMenu="matMenu">
          <ng-template matMenuContent>
            <div
              style="width: 140px;   max-height: 200px; overflow-y: auto; padding: 12px; font-family: Arial, sans-serif;">
              <h6 style="margin-bottom: 8px; font-weight: 600;">Message Info</h6>

              <!-- Delivered / Read Status -->
              <p style="margin: 4px 0; color: gray;">
                <strong>Delivered:</strong>

                <i class="bi" [ngClass]="{
                'bi-check-lg': !messageInfoData?.delivered ,
                'bi-check-all': messageInfoData?.delivered 
               }"></i>
              </p>
              <p style="margin: 4px 0; color: gray;">
                <strong>Read:</strong>
                <i class="bi bi-check-all" [ngClass]="{
                  'text-primary': messageInfoData?.read 
                }"></i>

              </p>

              <!-- Delivered By -->
              @if(deliveredKeys.length > 0) {
              <h6 style="margin-top: 12px; margin-bottom: 4px; font-weight: 500; color: #555;">Delivered By</h6>
              <ul style="list-style: none; padding-left: 0; margin: 0;">
                @for(userId of deliveredKeys ; track userId) {
                <li style="padding: 4px 0; font-size: 14px; color: #333;">
                  <strong>User {{ userId }}</strong>
                  <span style="float: right; color: gray; font-size: 12px;">
                    {{ messageInfoData!.deliveredByAt[userId] | date:'shortTime' }}
                  </span>
                </li>
                }
              </ul>
              }

              <!-- Read By -->
              @if(readKeys.length > 0) {
              <h6 style="margin-top: 12px; margin-bottom: 4px; font-weight: 500; color: #555;">Read By</h6>
              <ul style="list-style: none; padding-left: 0; margin: 0;">
                @for(userId of readKeys ;track userId) {
                <li style="padding: 4px 0; font-size: 14px; color: #333;">
                  <strong>User {{ userId }}</strong>
                  <span style="float: right; color: gray; font-size: 12px;">
                    {{ messageInfoData!.readByAt[userId] | date:'shortTime' }}
                  </span>
                </li>
                }
              </ul>
              }


            </div>
          </ng-template>
        </mat-menu>
        }
        }
      </div>


      <!-- Reply Preview -->
      @if(replyingToMessage()) {
      <div class="p-2 border-top bg-white d-flex align-items-center">
        <div class="flex-grow-1">
          <small class="text-muted">Replying to <strong>{{ replyingToMessage()!.senderAvatar.userId == activeUserId ?
              'you' : replyingToMessage()!.senderAvatar.username}}</strong></small>
          <div>{{ replyingToMessage()!.content }}</div>
        </div>
        <button class="btn btn-sm btn-light" (click)="cancelReply()">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      }
      <!-- File / Image Preview -->
      @if (selectedFile) {
      <div class="p-2 border-top bg-light d-flex align-items-center">
        <div class="me-2">
          @if (isImage(selectedFile)) {
          <img [src]="filePreviewUrl" alt="preview" class="rounded" style="max-height: 80px; max-width: 120px;" />
          } @else {
          <span class="fw-bold">{{ selectedFile.name }}</span>
          }
        </div>
        <button class="btn btn-sm btn-outline-danger ms-auto" (click)="removeAttachment()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      }

      <!-- Input Area -->
      <div class="p-2 border-top d-flex bg-white align-items-center">
        <!-- File Upload -->
        <button class="btn btn-light me-2" (click)="fileInput.click()">
          <mat-icon>attach_file</mat-icon>
        </button>
        <input type="file" #fileInput hidden accept="image/*,video/*" (change)="onFileSelected($event)" />

        <!-- Message Box -->
        <textarea class="form-control me-2" [(ngModel)]="messageToSent" placeholder="Type a message" rows="1"
          (input)="autoResize($event)" (keyup.enter)="sendMessage()" style="resize: none; overflow: hidden;"></textarea>

        <!-- Send Button -->
        <button class="btn btn-success" (click)="sendMessage()">
          <mat-icon>send</mat-icon>
        </button>
      </div>

      }
    </div>
  </div>
</div>